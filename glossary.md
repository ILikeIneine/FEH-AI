<h1 align = "center">Glossary</h1>

## 1.Important Concepts

###  	a. Slot Order(位置顺序值)

对于大多数情况下，AI必须在多个角色之间进行选择的情况下，角色顺序是最终的判断方式，唯一的例外是进攻性移动支援。支援角色将检查目标所在的位置。

<center>角色排位顺序是从低到高，从左到右。</center>

![slotorder](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Cslotorder.png)

在前面提到的的最终判断，较低的槽位将使单位具有移动的优势和支援的优先权。较高的插槽编号将使该单位在被盟友和敌人作为目标时具有更高的优先级，但同时在进行攻击的优先级上也将更具有优势。

敌人也有类似于插槽顺序，不过是基于地图位置的。尽管在竞技场对战的时候，敌人的部署同样也对应的是玩家的位置，但无法一目了然地推算出他们的插槽编号。但是，通常的模式是，在给定的地图中，英雄的插槽位置比普通敌人的插槽位置低。例外情况在FEH wiki里好像都有存储每张地图的敌方插槽顺序信息，可以去搜索: (    （不会真有人是分奴吧？不会吧不会吧不会吧？不会我就是那个分奴吧？）

援军的插槽号是在当前部署单位向后依次推算，已经死亡的单位的插槽不会消失，依旧默认存在，援军会使用最后一个没有没有被使用的插槽。举个例子，如果开局敌人有4个单位，并且在第2回合中出现援军，那么援军将位于第5个位置。

如果在一个回合中会有多个援军空降，且如果他们共享==相同的触发条件==（例如，在第2回合将会出现两个增援部队，或杀死军团(legion)后会出现两个增援部队），那么他们会根据地图，有一个预先分配的任意的槽位顺序。如果他们触发点不同（例如，一个增援来自杀死一个红色法师，而另一个则来自杀死一个蓝色法师），那么它们的槽位值取决于它们各自的部署机制。如果像前面的示例中那样，两个不同的击杀产生了两个增援，则它们的槽位值与其击杀目标的槽位值相对应（红色法师的槽位值，就是击杀而他产生的增援的槽位值，继承）。如果两个援军是同时通过击杀触发和基于回合触发，那么基于击杀触发的援兵的插槽值会优先于基于回合触发产生的援军，槽位值会小1位。

###  	b. Tile Priorty(位置优势)

位置优势（？？？）是当AI在地图上进行行动时，在选择位置的的所有情况下的最终判断依据。位置优先级从地图的左下角开始，从最低到最高编号，向右移动，然后回绕到每一行。因此，最高优先级图块位于地图的右上角。



![tilepriority](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Ctilepriority.png)

<center >Priority Example</center>

一种形象化地记住这种位置优先级的方法是，记住优先级是：上>右>左>下。更高行的位置总具有更高的优先权，靠右的总比靠左的优先级更高。

### c. Calculating Distance(计算距离)

距离计算是通过一个函数，为了执行各种最终判断，这个函数决定了单位/位置 A 到单位/位置 B 的距离。距离计算是一个单向计算，这意味着从A到B的距离不必与从B到A的距离相同。这是因为，距离借助了A位置单位的移动方式和可能会阻碍因该单位移动的地形因素。

在这里计算距离时，实际上是在计算最短距离。因此，在计算从A到B的距离时，需要找到从A到B的最短路径。当我们构造这些道路时，我们应当附加权值，对于步兵来说，树林相当于两个移动距离；而沟壑对于骑兵则相当于三个瓦片的移动距离。

构造路径时，如果有单位A的移动类型不可穿越的地形是不能使用的。距离计算包括B占用的图块。这意味着，如果B位于单元A不可能移动到的地形上，可能根本没有可行路径。在这种情况下，该距离被认为是“不确定的”，在最终判断时，所有“未定义”的距离均被视为相等。

米娅到各种敌人的距离计算示例：

![distance](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Cdistance.png)

### d. Movement Order List(移动顺序)

很重要的是，移动顺序表是一个回合中唯一被保留参与的计算。每当一个单位执行动作时，从头开始重复计算每个步骤，但回合开始时生成的移动顺序列表除外。由于位置和距离才是运动顺序列表中的决定因素，它在回合中持续存在的事实意味着，任何移动刷新或者玩家使用的支援而导致的位置变化，又或者由于B技能的移动效果而导致与敌人的距离发生变化(i.e. Lunge)，或者简单的因为敌人的死亡，所有这些都不会影响回合中的移动顺序。

需要注意的是，移动顺序列表是在决定一个动作的第一次迭代期间创建的~~（？？?不知道是回合开始阶段还是进行第一个动作的同时基于动作触发创建好，猜测是前一种）~~，对于敌方AI来说，这个列表是在回合开始被创建。但是，对于玩家而言，它是在玩家让AI自动战斗的第一个动作过程中中创建的。如果玩家手动执行动作，然后再打开自动战斗，移动顺序表将会在玩家执行行动后的的背景状态下生成。这意味着即使玩家手动执行AI本来执行的相同的操作，移动顺序表却将由于前后完全不同的状态下被创建，并且导致AI的行动与未经玩家手动操作，而在回合开始阶段直接打开自动战斗的AI行动完全不同。但如果第一个动作是使用自动对战进行的，则玩家执行第二个动作，然后让自动对战再次接管，随后的自动对战仍将使用从自动战斗第一个动作生成的移动顺序列表。

## 2. Special Actions and States

### a. Offensive Movement Assit(进攻性移动支援)

进攻性移动支援是移动支援的一种特殊用法，仅在预战斗期间可用，目前仅涉及推，打，带回和替换。通常情况下，行动支援用于防御，以帮助减少队友的危险。但是，对于进攻性移动支援模式，它试图移动一个队友，以腾出空间让另一个盟友攻击被判断无法攻击到的敌人。这种情况很少见，因为要满足它有很多要求。

![off_move_assist](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Coff_move_assist.gif)

### b. Bodyblocking

身体阻挡是防御性移动支援的一种特殊方式。它看起来像是正常移动，因为在进行身体阻挡时，身体阻挡者实际上并没有使用其支援技能。但是，身体阻挡者必须装备有防御支援技能，并且能够在目标上使用该技能，只不过身体阻挡是在适用时，代替了支援技能。

![bodyblocking](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Cbodyblocking.gif)

身位阻挡的目的是通过封锁至少1个敌方近战单位通往队友的路径，以减少敌人对队友的威胁。几乎可以将其视为交换(Swap)的更具攻击性的版本。

### c. Block Breaking

摧毁障碍是一种特殊的运动行为方式。角色对可破坏的障碍进行攻击，但是这一行为与标准移动发生在同一个阶段。首先，一个单位确定其最佳移动位置，然后，所有比该位置更靠近敌人的块都可以被破坏。当然，这个单位也必须能够实际攻击到，比如远程位就不能贴脸打砖块。然后计算所有块的攻击位置。如果有不止一个土块，破坏的最佳选择是最接近最佳移动位置的土块，其次是安全性，然后是块的优先级。如果存在至少一个符合上述描述的块，则单位将会打破土块的动作而不进行移动。如果开始时没有任何适合破坏的块，那么该单位将决定是否要使用Pivot如果装备了，（或者Rally，在很极端的情况下）否则他们会照常移动。

### d. Shuffling

是一种特殊状态，会影响运动行为。一个单位只能在特定条件下获得该状态。首先，如果该单位与它可以到达的任何队友相邻，则该单位将无法获得该状态。这包括自身诱发的传送(e.g. 飞行前导，脱离路线)和队友诱发的(e.g. 支援路线)。下一个条件取决于单位的武器，如下：

如果该单位拥有远程武器，并且在敌人2个距离内或与易碎方块相邻，他们就可以获得该状态。

如果单位没有装备武器，并且在敌人的2个距离内==并且==与队友相邻。

装备有近战武器的单位永远不会获得该状态。

如果一个单位获得了该状态，则保持不动仍然是优先级最低的移动，因此他将尽可能尝试移动。

![shuffling](C:%5CUsers%5CPenny%5CDesktop%5CFEH%5CglossaryPics%5Cshuffling.gif)

该机制的主要目的是减少该单位可能阻止另一个单位进行攻击的机率。这种行为在无武器部队中更可能出现，因为他们更容易站着不动。

### e. Pass

该状态是被某些特定技能赋予的，到目前适合Fujin和 Yumi（不确定...）。受此状态影响的单位计算威胁范围的方式与平时不同，并且此外，在回合开始时不会像其他单位那样存储其移动范围值。相反，他们“记录下”敌人占领的位置，并通过计算时使用其移动范围来计算其威胁，同时将那些记录下的图块视为不可移动至。记录下的位置的列表在这里被称为“障碍物列表”。

除非在战斗中敌方单位的位置发生变化（包括带有pass的单位），敌方单位死亡，或者敌方单位被冲撞或带回影响，否则在回合开始时创建的障碍物清单将不会更改。这意味着即使盟军单位的位置由于移动，使用支援或死亡而发生变化，障碍物的位置也不会更新。万一敌方单位的位置因战斗而改变，障碍物列表分别针对其名单上的每个位置检查，以查看其上是否仍存在敌人或盟军。任何不再有敌人或盟友的位置都将从列表中删除。此外，还将检查每个具有pass技能的单位，以查看它们是否仍满足HP要求。如果他们不再符合要求，他们将失去pass状态。反之亦然。如果某个单位额以前没有pass状态，但现在满足HP要求，则它们将获得pass状态。